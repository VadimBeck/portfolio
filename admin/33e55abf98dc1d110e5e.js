(window.webpackJsonp=window.webpackJsonp||[]).push([[12],{419:function(e,t,r){},436:function(e,t,r){"use strict";var a=r(419);r.n(a).a},452:function(e,t,r){"use strict";r.r(t);var a=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"edit-block reviews__edit"},[r("h3",{staticClass:"edit-block__subtitle"},[e._v("Редактировать отзыв")]),r("form",{staticClass:"redact-form",on:{submit:function(t){return t.preventDefault(),e.editCurrentReview(t)}}},[r("div",{staticClass:"review-edit"},[r("div",{staticClass:"review-edit__image"},[r("div",{staticClass:"avatar-load"},[r("label",{staticClass:"avatar-load__field"},[r("div",{staticClass:"avatar-load__image",class:[{filled:e.renderedPhoto.length},{loaded:e.drag}],style:{backgroundImage:"url("+e.renderedPhoto+")"}},[r("img",{staticClass:"avatar-load__pic",attrs:{src:e.photoURL}})]),r("div",{staticClass:"avatar-load__desc"},[e._v("Изменить фото")]),r("input",{staticClass:"avatar-load__file",attrs:{type:"file"},on:{change:e.loadFile,drop:e.loadFile,dragover:function(t){e.drag=!0},dragleave:function(t){e.drag=!1}}})])])]),r("div",{staticClass:"review-edit__form"},[r("label",{staticClass:"redact-form__row"},[r("div",{staticClass:"redact-form__block",class:{error:e.validation.hasError("review.author")},attrs:{"data-title":"Имя автора"}},[r("input",{directives:[{name:"model",rawName:"v-model",value:e.review.author,expression:"review.author"}],staticClass:"redact-form__entry input",attrs:{type:"text"},domProps:{value:e.review.author},on:{input:[function(t){t.target.composing||e.$set(e.review,"author",t.target.value)},function(t){return e.checkField("review.author")}]}}),r("div",{staticClass:"validate"},[e._v(e._s(e.validation.firstError("review.author")))])]),r("div",{staticClass:"redact-form__block",class:{error:e.validation.hasError("review.occ")},attrs:{"data-title":"Титул автора"}},[r("input",{directives:[{name:"model",rawName:"v-model",value:e.review.occ,expression:"review.occ"}],staticClass:"redact-form__entry input",attrs:{type:"text"},domProps:{value:e.review.occ},on:{input:[function(t){t.target.composing||e.$set(e.review,"occ",t.target.value)},function(t){return e.checkField("review.occ")}]}}),r("div",{staticClass:"validate"},[e._v(e._s(e.validation.firstError("review.occ")))])])]),r("label",{staticClass:"redact-form__row"},[r("div",{staticClass:"redact-form__block redact-form__block--no-border",class:{error:e.validation.hasError("review.text")},attrs:{"data-title":"Отзыв"}},[r("textarea",{directives:[{name:"model",rawName:"v-model",value:e.review.text,expression:"review.text"}],staticClass:"redact-form__entry textarea",attrs:{name:"textarea",type:"text"},domProps:{value:e.review.text},on:{input:[function(t){t.target.composing||e.$set(e.review,"text",t.target.value)},function(t){return e.checkField("review.text")}]}}),r("div",{staticClass:"validate"},[e._v(e._s(e.validation.firstError("review.text")))])])]),r("div",{staticClass:"redact-form__buttons"},[r("button",{staticClass:"cancel-btn",on:{click:function(t){return t.preventDefault(),e.cancellEditMode(t)}}},[e._v("Отмена")]),r("button",{staticClass:"action-btn",attrs:{type:"submit",disabled:e.loading}},[e._v("Сохранить")])])])])])])};a._withStripped=!0;var i=r(56),o=r(84);function n(e,t,r,a,i,o,n){try{var s=e[o](n),c=s.value}catch(e){return void r(e)}s.done?t(c):Promise.resolve(c).then(a,i)}function s(e){return function(){var t=this,r=arguments;return new Promise((function(a,i){var o=e.apply(t,r);function s(e){n(o,a,i,s,c,"next",e)}function c(e){n(o,a,i,s,c,"throw",e)}s(void 0)}))}}function c(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}function l(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?c(Object(r),!0).forEach((function(t){d(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):c(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function d(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var u={mixins:[r(84).mixin],validators:{"review.author":function(e){return o.Validator.value(e).required("Заполните имя")},"review.occ":function(e){return o.Validator.value(e).required("Заполните титул")},"review.text":function(e){return o.Validator.value(e).required("Заполните отзыв")}},props:{currentReview:{type:Object,default:function(){},required:!0}},data:function(){return{review:l({},this.currentReview),renderedPhoto:"",loading:!1,drag:!1}},computed:{photoURL:function(){return"https://webdev-api.loftschool.com/".concat(this.currentReview.photo)}},methods:l({},Object(i.b)("reviews",["editReview","changeEditMode"]),{},Object(i.b)("tooltip",["showTooltip"]),{loadFile:function(e){if(this.drag=!1,e.target.files[0]){var t=e.target.files[0];this.review.photo=t,this.renderImage(t)}},renderImage:function(e){var t=this,r=new FileReader;try{r.readAsDataURL(e),r.onloadend=function(){t.renderedPhoto=r.result}}catch(e){this.showTooltip({error:"Ошибка чтения файла"})}},editCurrentReview:function(){var e=this;return s(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,e.$validate();case 3:if(t.sent){t.next=6;break}return t.abrupt("return");case 6:return e.loading=!0,t.next=9,e.editReview(e.review);case 9:e.showTooltip({success:"Изменения внесены"}),e.changeEditMode(!1),t.next=16;break;case 13:t.prev=13,t.t0=t.catch(0),e.showTooltip({error:t.t0.message});case 16:return t.prev=16,e.loading=!1,t.finish(16);case 19:case"end":return t.stop()}}),t,null,[[0,13,16,19]])})))()},cancellEditMode:function(){this.changeEditMode(!1)},checkField:function(e){var t=this;return s(regeneratorRuntime.mark((function r(){return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,t.$validate(e);case 2:case"end":return r.stop()}}),r)})))()}})},v=(r(436),r(55)),f=Object(v.a)(u,a,[],!1,null,"86510b14",null);f.options.__file="src/admin/components/reviewEditForm.vue";t.default=f.exports}}]);